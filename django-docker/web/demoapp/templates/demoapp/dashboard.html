{% extends 'index.html' %}

<!-------------------------------------------Project 출력-------------------------------------->
{% block content %}


<!-- 바디 부분 -->
<div class="content" style="display:flex; justify-content:space-evenly; flex-direction: row;">
    <!-- 해야할 일 컬럼 -->

    <div class="row" id="list1" style="flex-direction:column; width: 280px; background-color: #e4e4e4; border-radius:6px;" ondrop="drop(this, event);" ondragenter="return false;" ondragover="return false;" >
        <div style="padding:10px 15px 10px 25px;">
            <p class='counter1'  style="font-size:16px; font-weight:300; margin:0px;">해야할 일 </p>
        </div>

        {% for key, value in tasks.items %}
        {% if value.task_state == '해야할일'%}

        <!-- task 블럭 -->
        <div id="{{ key }}" class="col-lg-3 col-md-6 col-sm-6" style="max-width: 100%; max-height:20%" draggable="true" ondragstart="drag(this, event)">
            <div class="card card-stats">
                <div class="card-body ">
                    <div class="row">
                        <div class="col-7 col-md-8" style="flex:0 0 100%;  max-width:100%;">
                            <div class="numbers" style="cursor:pointer" style="cursor:pointer">
                                <p class="card-category" data-toggle="modal" data-target="#taskModal">{{ value.task_name }}</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div style="display:flex; flex-direction:row; justify-content:space-between">
                    <div class="card-footer" style="display:flex; flex-direction:row;">
                        <div style="display:flex; flex-direction:row;">

                            {% if value.task_bookmark == 'False' %}
                            <div class="bookmark" style="text-align: center; width: 25px; background-color: #e4e4e4; height: 25px; border-radius: 6px;margin-right:5px; cursor:pointer">
                                <i style="color:#ffffff;font-size:15px;margin: 5px 5px 5px 5px;" class="fa fa-star"></i>
                            </div>
                            {% endif %}

                            {% if value.task_attachment == 'None' %}
                            <div class="stats" style="text-align: center; width: 25px; background:#e4e4e4; height: 25px; border-radius: 6px; margin-right:5px;">
                                <i style="color:#ffffff;font-size:15px;margin: 5px 5px 5px 5px" class="fas fa-paperclip"></i>
                            </div>
                            {% endif %}


                            <div style="background-color:#e4e4e4; border-radius:6px; vertical-align: middle;">
                                <p style="margin: 2px 5px 0 5px;"> D-{{ value.task_ddate}} </p>
                            </div>
                        </div>
                    </div>
                    <div>
                        <img style="margin-right:15px; width: 35px; height:35px; border-radius: 20px"  src="{{ value.task_managerurl }}">
                    </div>
                </div>
            </div>
        </div>

        {% endif %}
        {% endfor %}

    </div>

    <!-- 진행중 컬럼 -->
    <div class="row" id="list2" style="flex-direction:column; width: 280px; background-color: #e4e4e4; border-radius:6px;" ondrop="drop(this, event)" ondragenter="return false;" ondragover="return false;" >
        <div style="padding:10px 15px 10px 25px;">
            <p class='counter2'  style="font-size:16px; font-weight:280; margin:0px;">진행중 </p>
        </div>

        {% for key, value in tasks.items %}
        {% if value.task_state == '진행중'%}

        <!-- task 블럭 -->
        <div id="{{ key }}" class="col-lg-3 col-md-6 col-sm-6" style="max-width: 100%; max-height:20%" draggable="true" ondragstart="drag(this, event)">
            <div class="card card-stats">
                <div class="card-body ">
                    <div class="row">
                        <div class="col-7 col-md-8" style="flex:0 0 100%;  max-width:100%;">
                            <div class="numbers" style="cursor:pointer" style="cursor:pointer">
                                <p class="card-category" data-toggle="modal" data-target="#taskModal">{{ value.task_name }}</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div style="display:flex; flex-direction:row; justify-content:space-between">
                    <div class="card-footer" style="display:flex; flex-direction:row;">
                        <div style="display:flex; flex-direction:row;">

                            {% if value.task_bookmark == 'False' %}
                            <div class="bookmark" style="text-align: center; width: 25px; background-color: #e4e4e4; height: 25px; border-radius: 6px;margin-right:5px">
                                <i style="color:#ffffff;font-size:15px;margin: 5px 5px 5px 5px;" class="fa fa-star"></i>
                            </div>
                            {% endif %}

                            {% if value.task_attachment == 'None' %}
                            <div class="stats" style="text-align: center; width: 25px; background:#e4e4e4; height: 25px; border-radius: 6px; margin-right:5px;">
                                <i style="color:#ffffff;font-size:15px;margin: 5px 5px 5px 5px" class="fas fa-paperclip"></i>
                            </div>
                            {% endif %}


                            <div style="background-color:#e4e4e4; border-radius:6px; vertical-align: middle;">
                                <p style="margin: 2px 5px 0 5px;"> D-{{ value.task_ddate}} </p>
                            </div>
                        </div>
                    </div>
                    <div>
                        <img style="margin-right:15px; width: 35px; height:35px; border-radius: 20px"  src="{{ value.task_managerurl }}">
                    </div>
                </div>
            </div>
        </div>

        {% endif %}
        {% endfor %}
    </div>

    <!-- 리뷰 컬럼 -->
    <div class="row" id="list3" style="flex-direction:column; width: 280px; background-color: #e4e4e4; border-radius:6px;" ondrop="drop(this, event)" ondragenter="return false;" ondragover="return false;" >
        <div style="padding:10px 15px 10px 25px;">
            <p class='counter3'  style="font-size:16px; font-weight:300; margin:0px;">리뷰 </p>
        </div>

        {% for key, value in tasks.items %}
        {% if value.task_state == '리뷰'%}

        <!-- task 블럭 -->
        <div id="{{ key }}" class="col-lg-3 col-md-6 col-sm-6" style="max-width: 100%; max-height:20%" draggable="true" ondragstart="drag(this, event)">
            <div class="card card-stats">
                <div class="card-body ">
                    <div class="row">
                        <div class="col-7 col-md-8" style="flex:0 0 100%;  max-width:100%;">
                            <div class="numbers" style="cursor:pointer" style="cursor:pointer">
                                <p class="card-category" data-toggle="modal" data-target="#taskModal">{{ value.task_name }}</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div style="display:flex; flex-direction:row; justify-content:space-between">
                    <div class="card-footer" style="display:flex; flex-direction:row;">
                        <div style="display:flex; flex-direction:row;">

                            {% if value.task_bookmark == 'False' %}
                            <div class="bookmark" style="text-align: center; width: 25px; background-color: #e4e4e4; height: 25px; border-radius: 6px;margin-right:5px">
                                <i style="color:#ffffff;font-size:15px;margin: 5px 5px 5px 5px;" class="fa fa-star"></i>
                            </div>
                            {% endif %}

                            {% if value.task_attachment == 'None' %}
                            <div class="stats" style="text-align: center; width: 25px; background:#e4e4e4; height: 25px; border-radius: 6px; margin-right:5px;">
                                <i style="color:#ffffff;font-size:15px;margin: 5px 5px 5px 5px" class="fas fa-paperclip"></i>
                            </div>
                            {% endif %}


                            <div style="background-color:#e4e4e4; border-radius:6px; vertical-align: middle;">
                                <p style="margin: 2px 5px 0 5px;"> D-{{ value.task_ddate}} </p>
                            </div>
                        </div>
                    </div>
                    <div>
                        <img style="margin-right:15px; width: 35px; height:35px; border-radius: 20px"  src="{{ value.task_managerurl }}">
                    </div>
                </div>
            </div>
        </div>

        {% endif %}
        {% endfor %}
    </div>

    <!-- 완료 컬럼 -->
    <div class="row" id="list4" style="flex-direction:column; width: 280px; background-color: #e4e4e4; border-radius:6px;" ondrop="drop(this, event)" ondragenter="return false;" ondragover="return false;" >
        <div style="padding:10px 15px 10px 25px;">
            <p class='counter4'  style="font-size:16px; font-weight:300; margin:0px;">완료 </p>
        </div>

        {% for key, value in tasks.items %}
        {% if value.task_state == '완료'%}

        <!-- task 블럭 -->
        <div id="{{ key }}" class="col-lg-3 col-md-6 col-sm-6" style="max-width: 100%; max-height:20%" draggable="true" ondragstart="drag(this, event)">
            <div class="card card-stats">
                <div class="card-body ">
                    <div class="row">
                        <div class="col-7 col-md-8" style="flex:0 0 100%;  max-width:100%;">
                            <div class="numbers" style="cursor:pointer" style="cursor:pointer">
                                <p class="card-category" data-toggle="modal" data-target="#taskModal">{{ value.task_name }}</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div style="display:flex; flex-direction:row; justify-content:space-between">
                    <div class="card-footer" style="display:flex; flex-direction:row;">
                        <div style="display:flex; flex-direction:row;">

                            {% if value.task_bookmark == 'False' %}
                            <div class="bookmark" style="text-align: center; width: 25px; background-color: #e4e4e4; height: 25px; border-radius: 6px;margin-right:5px">
                                <i style="color:#ffffff;font-size:15px;margin: 5px 5px 5px 5px;" class="fa fa-star"></i>
                            </div>
                            {% endif %}

                            {% if value.task_attachment == 'None' %}
                            <div class="stats" style="text-align: center; width: 25px; background:#e4e4e4; height: 25px; border-radius: 6px; margin-right:5px;">
                                <i style="color:#ffffff;font-size:15px;margin: 5px 5px 5px 5px" class="fas fa-paperclip"></i>
                            </div>
                            {% endif %}


                            <div style="background-color:#e4e4e4; border-radius:6px; vertical-align: middle;">
                                <p style="margin: 2px 5px 0 5px;"> D-{{ value.task_ddate}} </p>
                            </div>
                        </div>
                    </div>
                    <div>
                        <img style="margin-right:15px; width: 35px; height:35px; border-radius: 20px"  src="{{ value.task_managerurl }}">
                    </div>
                </div>
            </div>
        </div>

        {% endif %}
        {% endfor %}

    </div>
</div>
{% endblock %}

<!-------------------------------------------프로젝트 팝업창-------------------------------------->
<!--Todo 프로젝트 팝업창 및 변경하-->

{% block content_popup %}
<!-- 업무 팝업창 -->
<div class="modal fade" id="taskModal" tabindex="-1" role="dialog" aria-labelledby="taskModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">업무</h5>
                <div class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </div>
            </div>
            <div class="modal-body">
                <div style="display:flex; flex-direction:column;width:100%">
                    <p style="font-size:16px; margin: 5px 0 0 10px;"> 업무명</p>
                    <input class="form-control" value="개발환경 구축" type="text" size="20">
                </div>
                <div style="display:flex; flex-direction:row; margin-top=5px;">
                    <div style="display:flex; flex-direction:column;width:100%;">
                        <p style="font-size:16px; margin: 5px 0 0 10px;"> 업무 마감 날짜 </p>

                        <div class="col-xs-3" style="margin:5px">
                            <div class="controls">
                                <input class="datepicker form-control"style="margin:0;" value="2019-08-30" type="text"/>
                            </div>
                        </div>

                    </div>
                    <div style="display:flex; flex-direction:column;width:100%">
                        <p style="font-size:16px; margin: 5px 0 0 10px;"> 담당자</p>
                        <div>
                            <select class="test">
                                <optgroup label="빅데이터팀">
                                    <option value="1">박형준</option>
                                </optgroup>
                                <optgroup label="통합 App Proj. 팀">
                                    <option value="2">박예은</option>
                                    <option value="3">정용원</option>
                                </optgroup>
                                <optgroup label="디지털사업팀">
                                    <option value="4">김성우</option>
                                    <option value="5">한석환</option>
                                </optgroup>
                                <optgroup label="IT기획팀">
                                    <option value="6">김동우</option>
                                    <option value="7" selected>김익준</option>
                                    <option value="8">김정은</option>
                                </optgroup>
                            </select>
                        </div>
                    </div>
                </div>
                <div>
                    <p style="font-size:16px; margin: 5px 0 0 10px;"> 업무 내용</p>
                    <textarea class="form-control" style="height:200px; max-height:200px; padding:10px">프론트개발, 도메인 생성, UI/UX기반 참고</textarea>
                </div>
                <div style="display:flex; flex-direction:column;width:100%">
                    <p style="font-size:16px; margin: 5px 0 0 10px;"> 첨부파일</p>
                    <input class="form-control" type="file" size="20" multiple>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-issue" style="background-color: gray;">이슈로 보내기</button>
                <button type="button" class="btn btn-primary" style="background-color: gray;">수정 완료</button>
            </div>
        </div>
    </div>
</div>


{% endblock %}

<!-------------------------------------------Plus 버튼과 기능-------------------------------------->
{% block plus %}

 <!--Todo 프로젝트 생성, 이슈로 보내기 -->

<!-- 추가 버튼 -->
<div style="text-align: -webkit-right;">
    <div class="plusbtn" data-toggle="modal" data-target="#exampleModal">
        <i class="fas fa-plus" style="font-size:35px; color:gray; margin-top:8px"></i>
    </div>
</div>
<!-- 업무 추가 팝업창 -->
<form name="myForm" onsubmit="return validateForm()" method="post">
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <form id="">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">업무 생성하기</h5>
                <div class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </div>
            </div>
            <div class="modal-body">
                <div style="display:flex; flex-direction:column;width:100%">
                    <p style="font-size:16px; margin: 5px 0 0 10px;"> 업무명</p>
                    <input class="form-control" type="text" size="20">
                </div>
                <div style="display:flex; flex-direction:row; margin-top=5px;">
                    <div style="display:flex; flex-direction:column;width:100%;">
                        <p style="font-size:16px; margin: 5px 0 0 10px;"> 업무 마감 날짜</p>

                        <div class="col-xs-3" style="margin:5px">
                            <div class="controls">
                                <input class="datepicker form-control"style="margin:0;" type="text"/>
                            </div>
                        </div>

                    </div>
                    <div style="display:flex; flex-direction:column;width:100%">
                        <p style="font-size:16px; margin: 5px 0 0 10px;"> 담당자</p>
                        <div>
                            <select class="test">
                                <option value="" selected disabled>선택해주세요.</option>
                                <optgroup label="빅데이터팀">
                                    <option value="1">박형준</option>
                                </optgroup>
                                <optgroup label="통합 App Proj. 팀">
                                    <option value="2">박예은</option>
                                    <option value="3">정용원</option>
                                </optgroup>
                                <optgroup label="디지털사업팀">
                                    <option value="4">김성우</option>
                                    <option value="5">한석환</option>
                                </optgroup>
                                <optgroup label="IT기획팀">
                                    <option value="6">김동우</option>
                                    <option value="7">김익준</option>
                                    <option value="8">김정은</option>
                                </optgroup>
                            </select>
                        </div>
                    </div>
                </div>
                <div>
                    <p style="font-size:16px; margin: 5px 0 0 10px;"> 업무 내용</p>
                    <textarea class="form-control" style="height:200px; max-height:200px; padding:10px"></textarea>
                </div>
                <div style="display:flex; flex-direction:column;width:100%">
                    <p style="font-size:16px; margin: 5px 0 0 10px;"> 첨부파일</p>
                    <input class="form-control" type="file" size="20" multiple>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" style="background-color: gray;">완료</button>
            </div>
        </div>
    </div>
    </form>
</div>
</form>
{% endblock %}

<!-------------------------------------------Dashboard Sidebar 호출-------------------------------------->
{% block sidebar %}
<li class="active">
    <a href="/main/">
        <i class="nc-icon nc-tile-56"></i>
        <p>업무</p>
    </a>
</li>
<li>
    <a href="/timeline/">
        <i class="nc-icon nc-bullet-list-67"></i>
        <p>타임라인</p>
    </a>
</li>
<li>
    <a href="/issue/">
        <i class="nc-icon nc-chat-33"></i>
        <p>이슈</p>
    </a>
</li>
<li>
    <a href="/meeting/">
        <i class="nc-icon nc-calendar-60"></i>
        <p>캘린더</p>
    </a>
</li>
<li>
    <a href="/drive/">
        <i class="nc-icon nc-box-2"></i>
        <p>드라이브</p>
    </a>
</li>
{% endblock %}

{% block script %}


<script type="text/javascript">
$('.bookmark').click(function() {
    if($(this).css('background-color') =='rgb(251, 198, 88)') {
      $(this).css('background-color', '#e4e4e4');
    } else {
      $(this).css('background-color', 'rgb(251, 198, 88)');
    }
});
</script>

<script type="text/javascript">
    $(".content").change(function(){
        var a = $("#list1").find("[id^=task]").length;
        var b = $("#list2").find("[id^=task]").length;
        var c = $("#list3").find("[id^=task]").length;
        var d = $("#list4").find("[id^=task]").length;
        $("select option:selected").each(function(){
                str += $(this).text() + " ";
            });
            $("div").text(str);
        }).change();
        $(".counter1").append(a);
        $(".counter2").append(b);
        $(".counter3").append(c);
        $(".counter4").append(d);
        }).change();
</script>


<script type="text/javascript">
function drag(target, task) {   //드래그 시작시 호출 할 함수
  task.dataTransfer.setData('Text', target.id);
};
function drop(target, task) {   //드롭시 호출 할 함수
  var id = task.dataTransfer.getData('Text');
  target.appendChild(document.getElementById(id));
  task.preventDefault();
};
</script>

<script>
var firebaseConfig = {
    apiKey: "AIzaSyAD9cgR44bN3rFqgQ_UDSJDMi4Krv2q58k",
    authDomain: "web-test-f1437.firebaseapp.com",
    databaseURL: "https://web-test-f1437.firebaseio.com",
    projectId: "web-test-f1437",
    storageBucket: "web-test-f1437.appspot.com",
    messagingSenderId: "147985162974",
    appId: "1:147985162974:web:0772d3ad436a42f5"
    };

    firebase.initializeApp(firebaseConfig);

    var db = firebase.database().ref()

    var user_projects = db.child("Members").child("{{ user_key}}").child("project");
    var all_projects = db.child("Project")

    console.log(.form-control)

function validateForm(){
    var proj_name = document.forms["myForm"][""]
}
</script>
{% endblock %}
